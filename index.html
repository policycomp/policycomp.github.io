<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Policy Composition From and For Heterogeneous Robot Learning">
  <meta name="keywords" content="Multitask, Multimodal, Robotics">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Policy Composition From and For Heterogeneous Robot Learning</title>

  <link href="http://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

 
 
  <script>
  function toggleCode() {
    var code = document.getElementById('code');
    if (code.style.display === 'none') {
      code.style.display = 'block';
    } else {
      code.style.display = 'none';
    }
  }    

    function updatesingletaskreal() {
      var task = document.getElementById("single-menu-tasks-single-task-real").value;
      var inst = document.getElementById("single-menu-instances-single-task-real").value;

      console.log("gpt", task, inst)

      var video = document.getElementById("single-task-result-video-single-task-real");
      video.src = "media/local_video/real_hammer_overhead/" + "episode_" + task + "_" +  inst + ".mp4";
      video.playbackRate = 2.0;
      video.play();
    }

    function updatesingletasksimreal() {
      var task = document.getElementById("single-menu-tasks-single-task-realsim").value;
      var inst = document.getElementById("single-menu-instances-single-task-realsim").value;

      console.log("gpt", task, inst)

      var video = document.getElementById("single-task-result-video-single-task-realsim");
      video.src = "media/local_video/compose_sim_real_hammer_overhead" + 
                    "/episode_" + task + "_" +  inst  + ".mp4";
      video.playbackRate = 2.0;
      video.play();
    }


    function updateMultitaskUnCond() {
      var task = document.getElementById("single-menu-tasks-multi-task-uncond").value;
      var inst = document.getElementById("single-menu-instances-multi-task-uncond").value;

      console.log("gpt", task, inst)

      var video = document.getElementById("single-task-result-video-multi-task-uncond");
      video.src = "media/local_video/multitask_uncond_" + task + "_gelsight_overhead/episode_" + 
                   inst  + ".mp4";
      video.playbackRate = 2.0;
      video.play();
    }

    function updateMultitaskComp() {
      var task = document.getElementById("single-menu-tasks-multi-task-comp").value;
      var inst = document.getElementById("single-menu-instances-multi-task-comp").value;

      console.log("gpt", task, inst)

      var video = document.getElementById("single-task-result-video-multi-task-comp");
      video.src = "media/local_video/multitask_comp_" + task + "_gelsight_overhead/episode_" + 
                   inst  + ".mp4";;
      video.playbackRate = 2.0;
      video.play();
    }

     
    timeoutIds = [];

  </script>

</head>
<body>



<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Policy Composition From and For Heterogeneous Robot Learning</h1>
  <!--         <div class="is-size-5 publication-authors">
            <span class="author-block">Anonymous ICLR Submission</span>
          </div>
 -->
         <div class="is-size-5 publication-authors">
            <span class="author-block">Anonymous</span>          
            </span>
          </div> 
<!--           <div class="is-size-5 publication-authors">
            <span class="author-block">Lirui Wang,</span>
            <span class="author-block">Alan Zhao,</span>
            <span class="author-block">Yilun Du,</sup>    
            <span class="author-block">Ted Adelson,</sup>     
            <span class="author-block">Russ Tedrake</sup>                 
            </span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block">MIT CSAIL</span>          
            </span>
          </div>   -->
          <br>
        
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2310.01361"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
<!-- 
              <span class="link-block">
                <a href="https://x.com/LiruiWang1/status/1711417032653324354?s=20"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-twitter"></i>
                  </span>
                  <span>Twitter</span>
                </a>
              </span> -->
           
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-fullhd">
    <div class="hero-body">
        <img src="media/figures/framework.png" class="interpolation-image" 
         alt="Interpolate start reference image." />  
      <h2 class="subtitle has-text-centered">
      </br>
        <span class="dcliport"><b>Policy Composition</b></span> can compose data across domains, modalities, and tasks using diffusion models. The composed policy demonstrates robust scene-level and task-level generalization in <b>generalizable tool-use tasks</b>.
      </h2>
    </div>
  </div>
</section>
<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop height="100%">
            <source src="media/cut_video/hammer_moving_object_output.mp4"
                    type="video/mp4">
          </video>
        </div>  
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop height="100%">
            <source src="media/cut_video/spatula_multi_trial_output.mp4"
                    type="video/mp4">
          </video>
        </div>  
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop height="100%">
            <source src="media/cut_video/diffusion_wrench_success_output.mp4"
                    type="video/mp4">
          </video>
        </div>  
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop height="100%">
            <source src="media/cut_video/diffusion_knife_success_output.mp4"
                    type="video/mp4">
          </video>
        </div>                                
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop height="100%">
            <source src="media/cut_video/spatula_robustness_moving_output.mp4"
                    type="video/mp4">
          </video>
        </div>        
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop height="100%">
            <source src="media/cut_video/human_hammer_merged.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop height="100%">
            <source src="media/cut_video/hammer_disturbance_object_output.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop height="100%">
            <source src="media/cut_video/sim_video.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop height="100%">
            <source src="media/cut_video/teleop_video.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section>
  <h2 class="subtitle has-text-centered">
    <br>

 </h2>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
Training general robotic policies from heterogeneous data for different tasks is challenging. Large volumes of robotic data are under different modalities such as color, depth, tactile, and proprioceptive information, and in different domains such as simulation, real robots, and human videos. Existing methods usually collect and pool all data from one domain to train a single policy to handle such heterogeneity in tasks and domains, which is prohibitively expensive and difficult. 

<br><br>In this work, we present a flexible approach, Policy Composition, to combine information across such diverse modalities and domains for scene-level and task-level generalized manipulation skills, by composing different data distributions represented with diffusion models. Furthermore, our method can use classifier-free  composition for multi-task manipulation and be composed with analytic cost functions to adapt policy behaviors at inference time. We train our method on simulation, human, and real robot data and evaluate in generalizable tool-use tasks. The composed policy achieves robust and dexterous performance under varying scenes and tasks and outperforms baselines from a single data source in both simulation and real-world evaluations.
          </p>
        </div>
      </div>
    </div>
</section>



<section class="section">
  <div class="container is-max-widescreen">

<div class="rows">
  <div class="row is-full-width half-width is-centered">
    <h3 class="title is-4">Overview</h3>
        <img src="media/figures/network.png" class="interpolation-image" 
         alt="Interpolate start reference image." />  
    <br/>


  </div>
</div>


  </div>
</section>


<section class="section">
  <div class="container is-max-widescreen">
    <div class="rows">
    <!-- Animation. -->
    <h2 class="title is-3  has-text-centered">Real-Robot Experiments</h2>

    <div class="container  ">
    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-half">
        <h3 class="title is-3">Real Only</h3>

        <div class="columns">
          <div class="column has-text-centered">
            Task  
            <div class="select is-small">     
              <select id="single-menu-tasks-single-task-real" onchange="updatesingletaskreal()">
        <option value="object_pose">object_pose</option>
        <option value="robot_pose">tool_pose</option>        
        <option value="distractor">distractor</option>
        <option value="new_instance" selected="selected">new_instance</option> 
              </select>
            </div>
            instance
            <div class="select is-small">
              <select id="single-menu-instances-single-task-real" onchange="updatesingletaskreal()">
              <option value="0" >01</option>
              <option value="1">02</option>
              <option value="2">03</option>
              <option value="3" selected="selected">04</option>
              <option value="4">05</option>              
              </select>
            </div>
            <br/>
            <br/>				
            <video id="single-task-result-video-single-task-real"
                   controls
                   muted
                   autoplay
                   loop
                   width="80%">
              <source src="media/local_video/real_hammer_overhead/episode_new_instance_3.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
    </div>        
      <div class="column is-half">
        <h3 class="title is-3">Real+Sim</h3>
        <div class="columns">
          <div class="column has-text-centered">
            Task  
            <div class="select is-small">     
              <select id="single-menu-tasks-single-task-realsim" onchange="updatesingletasksimreal()">
        <option value="object_pose">object_pose</option>
        <option value="robot_pose">tool_pose</option>        
        <option value="distractor">distractor</option>
        <option value="new_instance" selected="selected">new_instance</option> 
              </select>
            </div>
            instance
            <div class="select is-small">
              <select id="single-menu-instances-single-task-realsim" onchange="updatesingletasksimreal()">
              <option value="0" >01</option>
              <option value="1">02</option>
              <option value="2">03</option>
              <option value="3" selected="selected">04</option>
              <option value="4">05</option>              
              </select>
            </div>
            <br/>
            <br/>				
            <video id="single-task-result-video-single-task-realsim"
                   controls
                   muted
                   autoplay
                   loop
                   width="80%">
              <source src="media/local_video/compose_sim_real_hammer_overhead/episode_new_instance_3.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-widescreen">
    <div class="rows">
    <!-- Animation. -->

    <div class="container  ">
    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-half">
        <h3 class="title is-3">Multitask Unconditional</h3>

        <div class="columns">
          <div class="column has-text-centered">
            Task  
            <div class="select is-small">     
              <select id="single-menu-tasks-multi-task-uncond" onchange="updateMultitaskUnCond()">
        <option value="wrench">wrench</option>
        <option value="hammer">hammer</option>        
        <option value="knife">knife</option>
        <option value="spatula" selected="selected">spatula</option> 
              </select>
            </div>
            instance
            <div class="select is-small">
              <select id="single-menu-instances-multi-task-uncond" onchange="updateMultitaskUnCond()">
              <option value="0" selected="selected">01</option>
              <option value="1">02</option>
              <option value="2">03</option>
              <option value="3">04</option>
              <option value="4">05</option>              
              </select>
            </div>
            <br/>
            <br/>       
            <video id="single-task-result-video-multi-task-uncond"
                   controls
                   muted
                   autoplay
                   loop
                   width="80%">
              <source src="media/local_video/multitask_uncond_spatula_gelsight_overhead/episode_0.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
    </div>        
      <div class="column is-half">
        <h3 class="title is-3">Multitask Compositional</h3>
        <div class="columns">
          <div class="column has-text-centered">
            Task  
            <div class="select is-small">     
              <select id="single-menu-tasks-multi-task-comp" onchange="updateMultitaskComp()">
        <option value="wrench">wrench</option>
        <option value="hammer">hammer</option>        
        <option value="knife">knife</option>
        <option value="spatula" selected="selected">spatula</option> 
              </select>
            </div>
            instance
            <div class="select is-small">
              <select id="single-menu-instances-multi-task-comp" onchange="updateMultitaskComp()">
              <option value="0" selected="selected">01</option>
              <option value="1">02</option>
              <option value="2">03</option>
              <option value="3">04</option>
              <option value="4">05</option>              
              </select>
            </div>
            <br/>
            <br/>       
            <video id="single-task-result-video-multi-task-comp"
                   controls
                   muted
                   autoplay
                   loop
                   width="80%">
              <source src="media/local_video/multitask_comp_spatula_gelsight_overhead/episode_0.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="https://github.com/nerfies/nerfies.github.io" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered has-text-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website template is borrowed from  <a
              href="https://github.com/nerfies/nerfies.github.io">nerfie</a> 
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
